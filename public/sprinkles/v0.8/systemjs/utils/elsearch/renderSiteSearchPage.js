System.register(["../../../_chunks/initHannaNamespace-ae0195f6.js","../../../_chunks/compat.module-f329784f.js","../../../_chunks/qj-0feb5801.js","../../../_chunks/jsxRuntime.module-2cafdad3.js","../../../_chunks/getSVGtext-ef8676a9.js","../../../_chunks/i18n-6c3e4ded.js","../../../_chunks/_Image-cd3692c7.js","../../../_chunks/_Link-7fe03f09.js","../../../_chunks/_useMobileMenuToggling-2178898f.js","../../../_chunks/Alert-878c3f7c.js","../../../_chunks/Tabs-62939ed3.js","../../../_chunks/SiteSearchInput-719f9941.js","../../../_chunks/ensureCSS-8b7d0e4a.js","../../../_chunks/getLang-45de5ff2.js","./reykjavik.is.js","../../../_chunks/_Button-4ce1d666.js","../../../_chunks/env-60bbcb5a.js","../../../_chunks/assets-cefd5009.js"],function(ye,We){"use strict";var V,k,N,R,H,Q,E,A,B,W,G,J,d,Y,q,P,Z,K,X,ee,te,re,ne,se,ie,ae;return{setters:[null,l=>{V=l._,k=l.h,N=l.T,R=l.p,H=l.y,Q=l.k,E=l.a,A=l.F,B=l.C},l=>{W=l.r,G=l.d,J=l.m},l=>{d=l.o,Y=l.m},null,l=>{q=l.D,P=l.g},l=>{Z=l.I},l=>{K=l.L},l=>{X=l.u},l=>{ee=l.A},l=>{te=l.T},l=>{re=l.S},l=>{ne=l.e},l=>{se=l.g},l=>{ie=l.searchResultsPageQuery,ae=l.postQuery},null,null,null],execute:function(){const l={is:["janúar","febrúar","mars","apríl","maí","júní","júlí","ágúst","september","október","nóvember","desember"],en:["January","February","March","April","May","June","July","August","September","Octóber","November","December"],pl:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"]},ve=(e,r)=>{e=typeof e=="string"?new Date(e):e;const n=e.getUTCDate(),s=l[r||q]||l[q],t=s[e.getUTCMonth()],i=e.getUTCFullYear();return s===l.en?`${t} ${n}, ${i}`:`${n}. ${t} ${i}`};function $(){return $=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},$.apply(this,arguments)}function be(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,F(e,r)}function F(e,r){return F=Object.setPrototypeOf||function(s,t){return s.__proto__=t,s},F(e,r)}function _e(e,r){if(e==null)return{};var n={},s=Object.keys(e),t,i;for(i=0;i<s.length;i++)t=s[i],!(r.indexOf(t)>=0)&&(n[t]=e[t]);return n}var z=new Map,L=new WeakMap,oe=0,Se=void 0;function we(e){return e?(L.has(e)||(oe+=1,L.set(e,oe.toString())),L.get(e)):"0"}function ke(e){return Object.keys(e).sort().filter(function(r){return e[r]!==void 0}).map(function(r){return r+"_"+(r==="root"?we(e.root):e[r])}).toString()}function Ie(e){var r=ke(e),n=z.get(r);if(!n){var s=new Map,t,i=new IntersectionObserver(function(a){a.forEach(function(o){var c,u=o.isIntersecting&&t.some(function(h){return o.intersectionRatio>=h});e.trackVisibility&&typeof o.isVisible>"u"&&(o.isVisible=u),(c=s.get(o.target))==null||c.forEach(function(h){h(u,o)})})},e);t=i.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:r,observer:i,elements:s},z.set(r,n)}return n}function le(e,r,n,s){if(n===void 0&&(n={}),s===void 0&&(s=Se),typeof window.IntersectionObserver>"u"&&s!==void 0){var t=e.getBoundingClientRect();return r(s,{isIntersecting:s,target:e,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:t,intersectionRect:t,rootBounds:t}),function(){}}var i=Ie(n),a=i.id,o=i.observer,c=i.elements,u=c.get(e)||[];return c.has(e)||c.set(e,u),u.push(r),o.observe(e),function(){u.splice(u.indexOf(r),1),u.length===0&&(c.delete(e),o.unobserve(e)),c.size===0&&(o.disconnect(),z.delete(a))}}var Te=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function ce(e){return typeof e.children!="function"}var ue=function(e){be(r,e);function r(s){var t;return t=e.call(this,s)||this,t.node=null,t._unobserveCb=null,t.handleNode=function(i){t.node&&(t.unobserve(),!i&&!t.props.triggerOnce&&!t.props.skip&&t.setState({inView:!!t.props.initialInView,entry:void 0})),t.node=i||null,t.observeNode()},t.handleChange=function(i,a){i&&t.props.triggerOnce&&t.unobserve(),ce(t.props)||t.setState({inView:i,entry:a}),t.props.onChange&&t.props.onChange(i,a)},t.state={inView:!!s.initialInView,entry:void 0},t}var n=r.prototype;return n.componentDidUpdate=function(t){(t.rootMargin!==this.props.rootMargin||t.root!==this.props.root||t.threshold!==this.props.threshold||t.skip!==this.props.skip||t.trackVisibility!==this.props.trackVisibility||t.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},n.componentWillUnmount=function(){this.unobserve(),this.node=null},n.observeNode=function(){if(!(!this.node||this.props.skip)){var t=this.props,i=t.threshold,a=t.root,o=t.rootMargin,c=t.trackVisibility,u=t.delay,h=t.fallbackInView;this._unobserveCb=le(this.node,this.handleChange,{threshold:i,root:a,rootMargin:o,trackVisibility:c,delay:u},h)}},n.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},n.render=function(){if(!ce(this.props)){var t=this.state,i=t.inView,a=t.entry;return this.props.children({inView:i,entry:a,ref:this.handleNode})}var o=this.props,c=o.children,u=o.as,h=_e(o,Te);return H(u||"div",$({ref:this.handleNode},h),c)},r}(Q);ue.displayName="InView",ue.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function Re(e){var r=e===void 0?{}:e,n=r.threshold,s=r.delay,t=r.trackVisibility,i=r.rootMargin,a=r.root,o=r.triggerOnce,c=r.skip,u=r.initialInView,h=r.fallbackInView,f=V(),g=k({inView:!!u}),y=g[0],I=g[1],b=N(function(_){f.current!==void 0&&(f.current(),f.current=void 0),!c&&_&&(f.current=le(_,function(j,v){I({inView:j,entry:v}),v.isIntersecting&&o&&f.current&&(f.current(),f.current=void 0)},{root:a,rootMargin:i,threshold:n,trackVisibility:t,delay:s},h))},[Array.isArray(n)?n.toString():n,a,i,o,c,t,h,s]);R(function(){!f.current&&y.entry&&!o&&!c&&I({inView:!!u})});var p=[b,y.inView,y.entry];return p.ref=p[0],p.inView=p[1],p.entry=p[2],p}const de=e=>{const{highlight:r,title:n,summary:s,href:t,meta:i,image:a}=e,o=r?"SearchResultsHighlightItem":"SearchResultsItem",c=Array.isArray(i)?i:[i];return d("li",{className:o,children:d(K,{className:`${o}__link`,href:t,children:[d("h3",{className:`${o}__title`,children:n}),c.length>0&&d("span",{className:`${o}__meta`,children:c.map((u,h)=>typeof u=="function"?u():u&&d("span",{children:u},h))}),r&&a&&d(Z,{bem:`${o}__image`,src:a}),d("div",{className:`${o}__summary`,dangerouslySetInnerHTML:{__html:s}})]})})},he={},U=(e,r)=>{let n=he[r];return n||(n=he[r]=new Intl.NumberFormat(r)),n.format(e)},je=()=>d(E,{children:["Úps, það hefur komið upp villa. Má bjóða þér að prófa aftur að leita?",d("br",{}),"Ef ekkert lát er á villunni þá kunnum við að meta að þú látir okkur vita."]}),Me={en:{lang:"en",loadQueryTitle:"Loading results...",resultsTitle:"results found for",noResultsTitle:"No results were found for",loadMore:"Load more"},is:{lang:"is",loadQueryTitle:"Sæki niðurstöður...",resultsTitle:"leitarniðurstöður fyrir",noResultsTitle:"Engar leitarniðurstöður fundust fyrir",loadMore:"Sækja fleiri"},pl:{lang:"pl",loadQueryTitle:"Ładowanie wyników...",resultsTitle:"wyniki wyszukiwania dla",noResultsTitle:"Nie znaleziono wyników dla",loadMore:"Załaduj więcej"}},Ve=e=>{const{domid:r,filters:n,activeIdx:s,setFilter:t,lang:i}=e,a=A(()=>(n||[]).map(({label:o,count:c})=>({label:o,badge:c&&U(c,i)})),[n,i]);return a.length?d(te,{role:"tablist","aria-controls":r,tabs:a,activeIdx:s||0,onSetActive:o=>t&&t(o)}):null},fe=e=>e.count?d("ol",{className:"SearchResults__list SearchResults__list--loading",children:W(1,e.count).map((r,n)=>d(de,{title:"...",summary:"",href:""},n))}):null,Ne=2,Le=e=>{const{status:r,hits:n,numItems:s,loadMore:t,pageSize:i,texts:a}=e,{lang:o}=a,c=(n||0)-(s||0),u=V(0),h=!t||u.current>=Ne,[f,g]=Re({rootMargin:"150px 0px 0px 0px",skip:h});return R(()=>{g&&t&&(u.current=u.current+1,t())},[g,t]),r==="loadingmore"?d(fe,{count:Math.min(i,c)}):r==="results"&&c&&t?d("button",{ref:f,className:"SearchResults__loadmore",type:"button",onClick:t,children:[a.loadMore," ",d("span",{className:"SearchResults__loadmore__count",children:["(",U(c,o),")"]})]}):null},xe=(e,r)=>{const{status:n,totalHits:s,query:t}=e;return d("h2",{className:"SearchResults__title",children:[n==="loadingquery"?r.loadQueryTitle:s?`${U(s,r.lang)} ${r.resultsTitle}`:r.noResultsTitle,d("span",{className:"SearchResults__query",children:t})]})},Oe=e=>{const{status:r,pageSize:n,items:s,hits:t}=e;return r==="loadingquery"||r==="loadingfilter"?d(fe,{count:Math.min(n,t||999)}):s&&s.length?d("ol",{className:"SearchResults__list",children:s.map((i,a)=>d(de,{...i},a))}):null},Ce=(e,r)=>{const{hits:n,items:s,status:t,pageSize:i,loadMore:a}=e;return d(Le,{hits:n,numItems:s&&s.length,status:t,pageSize:i,loadMore:a,texts:r})},Ee=e=>{const{filters:r,activeFilterIdx:n,setFilter:s,status:t,errorText:i,wrapperProps:a}=e,o=P(e,Me),c=X();return d("div",{...a,className:Y("SearchResults",t!=="results"&&t,(a||{}).className),children:[xe(e,o),d(Ve,{domid:c,filters:r,activeIdx:n,setFilter:s,lang:o.lang}),d("div",{className:"SearchResults__results",id:c,children:[Oe(e),t==="error"&&d(ee,{type:"error",children:i||je()}),Ce(e,o)]})]})},x=(...e)=>console.error("renderSiteSearchPage: ",...e),O=document.createElement("div"),Ae=(e,r)=>(e=e.trim(),e.indexOf(r)===0?e.slice(r.length).trim():e),qe=(e,r)=>e?(O.innerHTML=e,O.textContent=Ae(O.textContent,r),O.innerHTML):"",ge=e=>e&&e[0]!=null?e[0].value:"",Pe=(e,r)=>e.map(n=>{const{label:s,url_alias:t,url_internal:i,field_date:a,field_summary:o,rendered_search_result:c}=n,u=[],h=ge(a);return h&&u.push(ve(h,r)),{title:s,meta:u.length?u:void 0,summary:ge(o)||qe(c,s),href:t||i}}),$e=(e,r)=>{const{aggregateData:n={},totalHits:s}=r||{};return e.map(({name:t,label:i})=>({name:t,label:i,count:(t?n[t]:s)||0})).filter(t=>t.count>0)},Fe=e=>Object.entries({"":"Allt",...e}).map(([r,n])=>({name:r||"",label:n})),ze=10,pe=2,Ue={en:{searchInputLabel:"Enter your search query",searchPlaceholder:"Enter your search query",searchButtonText:"Search"},is:{searchInputLabel:"Sláðu inn leitarorð",searchPlaceholder:"Sláðu inn leitarorð",searchButtonText:"Leita"},pl:{searchInputLabel:"Wpisz wyszukiwane słowa",searchPlaceholder:"Wpisz wyszukiwane słowa",searchButtonText:"Szukaj"}},D={push:(e,r)=>{const n=r?"replaceState":"pushState",s=J(e),t=s?`?${s}`:"";history[n](null,"",t),window.dispatchEvent(new Event("minirouting"))},replace:e=>D.push(e,!0)},me=(e={})=>{const r=new URLSearchParams(window.location.search),n=r.get("q")||void 0,s=r.get("type")||void 0;return n!==e.q||s!==e.type?{q:n,type:s}:e},De=(e,r,n,s)=>{const t=A(()=>Fe(r),[r]),[i,a]=k(me),o=V({}),c=N(()=>{a(b=>(o.current=b,me(b)))},[]),[,u]=k(0);R(()=>(window.addEventListener("popstate",c),window.addEventListener("minirouting",c),()=>{window.removeEventListener("popstate",c),window.removeEventListener("minirouting",c)}),[c]);const[h,f]=k({items:[]}),g=V(),y=N((b=0)=>{const{q:p,type:_}=i,j=o.current,v=p!==j.q?"loadingquery":_!==j.type?"loadingfilter":b>0?"loadingmore":void 0;if(!v||!p||p.length<pe)return;f(S=>{var w,M;return{status:v,totalHits:v==="loadingquery"?void 0:S.totalHits,hits:v==="loadingquery"||(M=(w=S.filters)==null?void 0:w.find(C=>C.name===_))==null?void 0:M.count,items:v==="loadingmore"?S.items:[],filters:v==="loadingquery"?t.slice(0,1):S.filters}});const m=new AbortController,T=ie({value:p,filter:_&&t.find(S=>S.name===_)?[{term:{bundle:_}}]:void 0,from:b*n,size:n});return ae(e,T,m.signal).then(S=>{const[w,M]=S;if(!w||!M)throw new Error("query returned incomplete results");const C=Pe(M.items,s);f(Be=>({status:"results",totalHits:w.totalHits,hits:_?M.totalHits:w.totalHits,items:v==="loadingmore"?Be.items.concat(C):C,filters:$e(t,w)})),c(),g.current=void 0}).catch(S=>{m.signal.aborted||(g.current=void 0,x(S),f(w=>({...w,status:"error"})))}),()=>m.abort()},[i,t,n,e,c,s]);R(()=>(u(0),g.current&&g.current(),g.current=y(),()=>{g.current&&g.current()}),[y]);const I=N(()=>{g.current||u(b=>{const p=b+1;return g.current=y(p),p})},[y]);return{params:i,searchResults:h,loadMore:I}},He=()=>{const[e]=k(()=>G.d(500));return R(()=>e.cancel,[]),e},Qe=e=>{const{lang:r,apiUri:n,bundleLabels:s={},pageSize:t=ze}=e,i=P(e,Ue),{params:a,searchResults:o,loadMore:c}=De(n,s,t,r),[u,h]=k(a.q||""),f=He(),g=m=>{f.cancel(),m=m.trim(),(!m||m.length>=pe)&&m!==a.q&&f(()=>{D.replace({q:m||void 0})},500)},{filters:y,status:I,items:b,hits:p,totalHits:_}=o,j=y&&(m=>{var T;D.replace({q:a.q,type:(T=y[m])==null?void 0:T.name})}),v=y&&Math.max(0,y.findIndex(m=>a.type===m.name));return d(E,{children:[d(re,{label:i.searchInputLabel,placeholder:i.searchPlaceholder,buttonText:i.searchButtonText,value:u,onChange:m=>{const T=m.currentTarget.value;h(T),g(T)}}),I&&a.q&&d(Ee,{status:I,items:b,totalHits:_,hits:p,pageSize:t,query:a.q,activeFilterIdx:v,filters:y,setFilter:j,loadMore:c,lang:r})]})},Ge=ye("default",e=>{const{insertAt:r,apiUri:n,bundleLabels:s,pageSize:t}=e;if(!n||!s){!n&&x("`apiUri` missing"),!s&&x("`bundleLabels` missing");return}const i=document.querySelector(r);if(!i){x(`Insertion point "${r}" not found`);return}ne("SearchResults","SiteSearchInput").then(()=>{const a=document.createElement("div");a.className="SiteSearchPage",B.render(d(Qe,{apiUri:n,bundleLabels:s,pageSize:t,lang:se(i)}),a,()=>{i.replaceWith(a)})})})}}});

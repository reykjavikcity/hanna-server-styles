System.register(["../../_chunks/compat.module-f329784f.js","../../_chunks/qj-f4bfbfcd.js","../../_chunks/Alert-f414d2c7.js","../../_chunks/jsxRuntime.module-2cafdad3.js","../../_chunks/getSVGtext-ef8676a9.js","../../_chunks/i18n-6c3e4ded.js","../../_chunks/_Button-4ce1d666.js","../../_chunks/_Link-7fe03f09.js","../../_chunks/env-60bbcb5a.js","../../_chunks/_useMobileMenuToggling-5dfba98d.js"],function(k,E){"use strict";var S,g,w,u,_,A,I,m;return{setters:[r=>{S=r.h,g=r.p,w=r.a},r=>{u=r.S,_=r.M,A=r.D},r=>{I=r.A},r=>{m=r.o},null,null,null,null,null,null],execute:function(){const r="alert-dismissed-",M=14*A,b=()=>{if(Math.random()>.1)return;const e=Math.floor((Date.now()-M)/u);for(let s=0;s<localStorage.length;s++){const n=localStorage.key(s);n&&n.startsWith(r)&&Number(localStorage.getItem(n))<e&&localStorage.removeItem(n)}},j=(e,s)=>n=>{const i=n.showOnPages||[];if(i.length===0)return!0;const t=n.negateShowOnPages??!0;let c=!1;for(let l=0;l<i.length;l++){const h=s.replace(/\/$/,"")+i[l];if(h.charAt(h.length-1)==="*"){if(e.startsWith(h.substring(0,h.length-1))){c=!0;break}}else if(h===e){c=!0;break}}return t?!c:c},p=e=>!(e.dismissible&&(Number(localStorage.getItem(r+e.uuid))||-1)>=(e.dismissalIgnoreBefore||0)),D=(e,s,n)=>fetch(e).then(i=>i.json()).then(i=>{const t=i.sitewideAlerts,c=Math.ceil(Date.now()/u);return t.forEach(l=>{l.dismissible?(l.dismissalIgnoreBefore||0)>c&&(l.dismissible=!1):delete l.dismissalIgnoreBefore}),t.filter(p).filter(j(s,n))}).catch(i=>(console.error("Site wide alerts failed loading",i),[])),T=e=>{const s=Math.ceil(Date.now()/u);let n=!1;const i=e.map(t=>t.dismissible||t.dismissalIgnoreBefore||0>s?t:(n=!0,{...t,dismissible:!0}));return n?i:e},x=e=>{const s=Math.floor(Date.now()/u),i=e.filter(t=>(t.dismissalIgnoreBefore||-1)>s).reduce((t,{dismissalIgnoreBefore:c=0})=>t?Math.min(t,c):c,0)-s;return i>0?i:null},v={"alert-warning":"critical","alert-attention":"warning","alert-success":"success","alert-info":"info"},y=10*u,N=2*_,O=k("SiteWideAlerts",e=>{const{alertsUri:s,baseUrl:n="/",lang:i}=e,t=Math.max(e.refreshInterval||N,y),[c,l]=S([]);g(b,[]);const h=typeof window<"u"&&window.location.pathname;g(()=>{const o=()=>{D(s,h,n).then(f=>{l(d=>d.length!==f.length||JSON.stringify(d)!==JSON.stringify(f)?f:d)})};o();const a=setInterval(o,t);return()=>{clearInterval(a)}},[h,s,n,t]),g(()=>{const o=x(c)||0;if(o>0){const a=setTimeout(()=>{l(T)},(o+2)*u);return()=>{clearTimeout(a)}}},[c]);const R=({uuid:o})=>{window.localStorage.setItem(r+o,String(Math.round(Date.now()/u))),setTimeout(()=>{l(a=>{const f=a.filter(d=>d.uuid!==o);return f.length<a.length?f:a})},2e3)};return m(w,{children:c.map(o=>{const a=v[o.styleClass]||"info";return m(I,{type:a,childrenHTML:o.renderedAlert,onClose:o.dismissible?()=>R(o):void 0,lang:i},o.uuid)})})})}}});
